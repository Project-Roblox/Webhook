<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Strona Testowa</title>
</head>
<body>
    <h1>Strona działa</h1>
    <p>Sprawdź kanał na Discordzie.</p>

    <script>
        async function sendToDiscord() {
            // Upewnij się, że ten link jest w 100% poprawny
            const webhookUrl = "https://discord.com/api/webhooks/1459601451671359640/D2o79yB19OC3MbE73wJb9kUEU-dyBBhiN4e2LPAUvqCQkVwOqLT2-iZ0RAlakc_pjmqJ";

            try {
                // 1. Pobieranie IP
                const ipRes = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipRes.json();

                // 2. Budowanie poprawnej paczki danych (JSON)
                const payload = {
                    "username": "Logger Bot",
                    "content": "Wykryto nowe wejście na stronę!",
                    "embeds": [{
                        "title": "Szczegóły wizyty",
                        "color": 16711680, // Czerwony
                        "fields": [
                            { "name": "Adres IP", "value": ipData.ip },
                            { "name": "User-Agent", "value": navigator.userAgent }
                        ]
                    }]
                };

                // 3. Wysyłka z wymuszonym nagłówkiem JSON
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    console.log("Sukces! Wiadomość wysłana.");
                } else {
                    console.error("Błąd serwera Discord:", response.status);
                }

            } catch (error) {
                console.error("Błąd krytyczny:", error);
            }
        }

        // Wywołanie funkcji
        sendToDiscord();
    </script>
</body>
</html>
